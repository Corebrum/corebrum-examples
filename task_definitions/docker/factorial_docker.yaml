task_definition:
  name: "factorial_docker"
  version: "1.0"
  description: "Docker containerized factorial using embedded inputs; Zenoh publish"
  inputs:
    - name: "number"
      type: "number"
  outputs:
    - name: "result"
      type: "zenoh"
      key: "corebrum/examples/docker/factorial"
  validation: []
  metadata: {}
  
  compute_logic:
    type: "docker"
    language: "python"
    timeout_seconds: 30
    
    # Docker configuration
    code_source:
      type: "docker"
      url: "docker://python:3.9-slim"  # Required field, using docker:// scheme
      docker_image: "python"
      docker_tag: "3.9-slim"
      # Optional: custom code from external source
      # url: "https://raw.githubusercontent.com/user/repo/main/factorial.py"
    
    # Embedded Python code (will be used if no external source)
    code: |
      import json, time
      def factorial(n):
          if n < 0:
              raise ValueError("Factorial is not defined for negative numbers")
          result = 1
          for i in range(2, n + 1):
              result *= i
          return result
      number = int(inputs.get('number', 10))
      start = time.time(); value = factorial(number); end = time.time()
      output = {
          "factorial": value,
          "input_number": number,
          "computation_time_ms": int((end - start) * 1000),
          "method": "docker",
          "container_info": {"image": "python:3.9-slim", "execution_type": "containerized"}
      }
      print(json.dumps(output))
    
    input_schema:
      type: "object"
      properties:
        number:
          type: "integer"
          minimum: 0
          maximum: 20
          description: "Number to compute factorial for"
      required: ["number"]
      
    output_schema:
      type: "object"
      properties:
        factorial:
          type: "integer"
          description: "The computed factorial value"
        input_number:
          type: "integer"
          description: "The input number"
        computation_time_ms:
          type: "integer"
          description: "Time taken for computation in milliseconds"
        method:
          type: "string"
          description: "Execution method used"
        worker_id:
          type: "string"
          description: "ID of the worker that executed the task"
        container_info:
          type: "object"
          description: "Information about the Docker container"
        timestamp:
          type: "string"
          description: "Timestamp of execution"
      required: ["factorial", "input_number", "computation_time_ms", "method", "worker_id"]
      
  # Resource requirements
  resources:
    cpu_cores: 1
    memory_mb: 128
    timeout_seconds: 30
    
  # Metadata
  tags: ["mathematics", "factorial", "docker", "python", "containerized"]
  category: "computation"
  complexity: "low"
